var WasmLoader;if(function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(0===e.length)return".";for(var o,n=0;n<e.length;++n){var i=e[n];i.length>0&&(void 0===o?o=i:o+="/"+i)}return void 0===o?".":r(o)}function r(e){if(0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return e=o(e,!t),0!==e.length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e}function o(e,t){for(var r,o="",n=-1,i=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(n===a-1||1===i);else if(n!==a-1&&2===i){if(o.length<2||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){for(var s=o.length-1,u=s;u>=0&&47!==o.charCodeAt(u);--u);if(u!==s){o=u===-1?"":o.slice(0,u),n=a,i=0;continue}}else if(2===o.length||1===o.length){o="",n=a,i=0;continue}t&&(o.length>0?o+="/..":o="..")}else o.length>0?o+="/"+e.slice(n+1,a):o=e.slice(n+1,a);n=a,i=0}else 46===r&&i!==-1?++i:i=-1}return o}function n(e){if(0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,o=-1,n=!0,i=e.length-1;i>=1;--i)if(t=e.charCodeAt(i),47===t){if(!n){o=i;break}}else n=!1;return o===-1?r?"/":".":r&&1===o?"//":e.slice(0,o)}var i;if("undefined"!=typeof TextDecoder){var a=new TextDecoder("utf-8");i=function(e){return a.decode(e)}}else i=function(e){for(var t,r,o,n="",i=e.byteLength,a=0;a<i;)switch(t=e[a++],t>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(t);break;case 12:case 13:r=e[a++],n+=String.fromCharCode((31&t)<<6|63&r);break;case 14:r=e[a++],o=e[a++],n+=String.fromCharCode((15&t)<<12|(63&r)<<6|(63&o)<<0)}return n};var s=function(){function e(e,t){this.bodyLength=0,this.v=new Uint8Array(e),this.i=t}return e.FindSect=function(t,r){for(var o=new e(t,8),n=0,i=o.v.length;o.i<i;){if(n=o.ReadU32v(),n==r.length){for(var a=0;a!=n&&o.v[o.i++]==r[a++];);var s=a==n;if(n=o.ReadU32v(),s)return o.bodyLength=n,o}else o.i+=n,n=o.ReadU32v();o.i+=n}return null},e.prototype.SetOffs=function(e){this.i=e},e.prototype.Skip=function(e){var t=this.i+e;if(t>this.v.length)throw new Error("not enough data");this.i=t},e.prototype.ReadBuf=function(){return this.ReadBufOfLen(this.ReadU32v())},e.prototype.ReadUTF8Str=function(){return this.ReadUTF8StrOfLen(this.ReadU32v())},e.prototype.ReadBufOfLen=function(e){var t=this.i+e;if(t>this.v.length)throw new Error("not enough data");var r=this.v.subarray(this.i,t);return this.i+=e,r},e.prototype.ReadUTF8StrOfLen=function(e){var t=this.ReadBufOfLen(e),r=i(t);return r},e.prototype.ReadU32v=function(){var e=this.i,t=e+5;t>this.v.length&&(t=this.v.length);for(var r=0,o=0,n=0;this.i<t&&(n=this.v[this.i++],r|=(127&n)<<o,0!=(128&n));)o+=7;var i=this.i-e;if(this.i==t&&128&n)throw new Error("varint too large");if(0==i)throw new Error("varint of length 0");return r},e.SectIDType=Uint8Array.from([116,121,112,101]),e.SectIDImport=Uint8Array.from([105,109,112,111,114,116]),e}();!function(e){e[e.Wasm=0]="Wasm",e[e.JavaScript=1]="JavaScript"}(e.ModuleKind||(e.ModuleKind={}));var u=e.ModuleKind,f=function(){function e(e){this._modules=new Map,"object"==typeof e?(this.options=e,this.options.baseURL&&"/"!==this.options.baseURL.substr(-1)&&(this.options.baseURL+="/")):this.options={}}return e.prototype.load=function(e,t){var r=this;return new Promise(function(o,n){e=r.normalizeRef(e,t);var i=r._modules.get(e);i?i.loading?i.loading.push({resolve:o,reject:n}):i.error?n(i.error):o(i):(r._modules.set(e,{loading:[{resolve:o,reject:n}]}),r.fetch(e,t).then(function(t){return r._load(t.buf,t.kind,e)}))})},e.prototype.loadBuf=function(e,t,r,o){var n=this;return new Promise(function(i,a){if(r=n.normalizeRef(r,o),n._modules.has(r))throw new Error('module "'+r+'" already registered');n._modules.set(r,{loading:[{resolve:i,reject:a}]}),n._load(e,t,r)})},e.prototype.defineAMD=function(e,t,r,o){var n,i,a,s,u=this;if("string"==typeof arguments[0]?(n=arguments[0],arguments[1]instanceof Array?(i=arguments[1],a=arguments[2],s=arguments[3]||null):(i=null,a=arguments[1],s=arguments[2]||null)):arguments[0]instanceof Array?(n=null,i=arguments[0],a=arguments[1],s=arguments[2]||null):(n=null,i=null,a=arguments[0],s=arguments[1]||null),!a)throw new Error("missing factory");return new Promise(function(e,t){var r={loading:[{resolve:e,reject:t}],exports:{}};if(n){if(n=u.normalizeRef(n,s),u._modules.has(n))throw new Error('module "'+n+'" already registered');r.id=n,u._modules.set(n,r)}if(!i){if("object"==typeof a)return r.loading=null,r.exports=a,e(r);i=["require","exports","module"]}if("function"!=typeof a)throw new Error("factory is not a function");var o=i.map(function(e){return"require"===e?Promise.resolve(function(e){var t=u._modules.get(u.normalizeRef(e,n));if(!t||!t.exports||t.loading)throw new Error("module not found");return t.exports}):"exports"===e?Promise.resolve(r.exports):"module"===e?Promise.resolve(r):u.resolveImport(e,[],n)});Promise.all(o).then(function(e){var t=a.apply(null,e);void 0!==t&&(r.exports=t),r.loading.forEach(function(e){return e.resolve(r)}),r.loading=null})})},e.prototype._load=function(e,t,r){var o=this,n=this._modules.get(r),i=function(e){o._modules.set(r,e),n.loading.forEach(function(t){return t.resolve(e)})},a=function(e){n.loading.forEach(function(t){return t.reject(e)}),n.loading=null,n.error=e};switch(t){case u.Wasm:this._loadWasm(e,r,n).then(i).catch(a);break;case u.JavaScript:throw new Error("ModuleKind.JavaScript not implemented");default:throw new Error("invalid module kind")}},e.prototype._loadWasm=function(e,t,r){if(!this.options.skipVerification)try{Wasm.verifyModule(e)}catch(e){throw new Error("Invalid Wasm module: "+(e.message||String(e)))}var o=this.readWasmImports(e);return this.resolveImports(o,t).then(function(t){var r=Wasm.instantiateModule(e,t);return r.exports||(r={exports:{}}),r})},e.prototype.resolveImports=function(e,t){var r=this;return new Promise(function(o,n){var i={},a=1,s=function(){0===--a&&o(i)};e.forEach(function(e,o){++a,r.resolveImport(o,e,t).then(function(e){i[o]=e,s()}).catch(function(e){a=0,n(e)})}),s()})},e.prototype.resolveImport=function(e,t,r){return this.load(e,r).then(function(o){return t.forEach(function(t){if(!o.exports[t])throw new Error('no function "'+t+'" in module "'+e+'" imported by "'+r+'"')}),o.exports})},e.prototype.readWasmImports=function(e){var t=new Map,r=s.FindSect(e,s.SectIDImport);if(r)for(var o=r.ReadU32v(),n=0;n<o;++n){r.ReadU32v();var i=r.ReadUTF8Str(),a=r.ReadUTF8Str(),u=t.get(i);u||(u=[],t.set(i,u)),u.push(a)}return t},e.prototype.normalizeRef=function(e,r){return!r||"."!==e[0]||"/"!==e[1]&&"../"!==e.substr(0,3)||(e=t(n(r),e)),e},e.prototype.fetch=function(e,t){var r=e;return".wasm"!==r.substr(-5)&&(r+=".wasm"),this.options.baseURL&&"/"!==r[0]&&r.indexOf("://")===-1&&(r=this.options.baseURL+r),fetch(new Request(r)).then(function(o){if(!o.ok){if(o.status>=400&&o.status<500){var n='unknown module "'+e+'"';throw t&&(n+=" imported by "+t),new Error(n)}throw new Error(r+" "+o.statusText)}return o.arrayBuffer().then(function(e){return{buf:e,kind:u.Wasm}})})},e}();e.Loader=f,f.prototype.defineAMD.amd={}}(WasmLoader||(WasmLoader={})),"undefined"!=typeof exports)if("object"==typeof module)module.exports=WasmLoader;else for(var k in WasmLoader)exports[k]=WasmLoader[k];else("undefined"!=typeof window?window:"undefined"==typeof global||global.process?this:global).WasmLoader=WasmLoader;
//# sourceMappingURL=wasm-loader.js.map